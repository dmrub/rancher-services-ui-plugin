{"version":3,"sources":["webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue?8fd7","webpack://services-ui-0.1.0/./icons/gear.svg","webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue","webpack://services-ui-0.1.0/components/ServicesDashboardCard.vue","webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue?04e0","webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue?cc52","webpack://services-ui-0.1.0/./icons/gpu-card.svg","webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue?241d","webpack://services-ui-0.1.0/./components/ServicesDashboardCard.vue?7d7f","webpack://services-ui-0.1.0/./.shell/assets/brand sync ^\\.\\/.*\\/metadata\\.json$"],"names":["content","__esModule","default","module","i","locals","exports","add","render","_vm","this","_c","_self","attrs","serviceLinks","tableHeaders","scopedSlots","_u","key","fn","staticClass","on","$event","toggleShowBrokenLinks","_v","_s","toggleShowBrokenLinksButtonName","proxy","row","enabled","directives","name","rawName","value","undefined","t","expression","class","disabled","link","status","staticRenderFns","VERSION","components","SortableTable","props","resource","type","Object","required","fetchDeps","data","gpuCardIconSrc","require","gearIconSrc","version","icons","gear","externalLinks","showBrokenLinks","label","methods","currentCluster","$store","getters","inStore","services","dispatch","SERVICE","serviceIndex","service","serviceName","metadata","serviceNamespace","namespace","port","spec","ports","_port$name","_port$port","protocol","portName","portNum","isHttps","includes","isHttp","fetchPods","servicePort","serviceProtocol","serviceDescription","serviceId","serviceLink","id","serviceLinkEnabled","serviceLinkStatus","pods","length","response","$axios","get","timeout","toString","e","push","iconSrc","kind","description","computed","filter","component","___CSS_LOADER_API_IMPORT___","map","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","keys","resolve"],"mappings":"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","file":"services-ui-0.1.0.umd.min.2.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ServicesDashboardCard.vue?vue&type=style&index=0&id=43fccdda&prod&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0848c4ae\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","module.exports = __webpack_public_path__ + \"img/gear.f142545c.svg\";","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('SortableTable',{attrs:{\"rows\":_vm.serviceLinks,\"headers\":_vm.tableHeaders,\"key-field\":\"id\",\"table-actions\":false,\"search\":true},scopedSlots:_vm._u([{key:\"header-middle\",fn:function(){return [_c('button',{staticClass:\"btn btn-sm role-secondary\",attrs:{\"type\":\"button\",\"disabled\":false},on:{\"click\":function($event){return _vm.toggleShowBrokenLinks()}}},[_vm._v(\" \"+_vm._s(_vm.toggleShowBrokenLinksButtonName)+\" \")])]},proxy:true},{key:\"col:name\",fn:function({row}){return [(row.enabled)?_c('td',[_c('a',{directives:[{name:\"clean-tooltip\",rawName:\"v-clean-tooltip\",value:(!row.enabled ? _vm.t('services.list.na') : undefined),expression:\"!row.enabled ? t('services.list.na') : undefined\"}],class:{ disabled: !row.enabled },attrs:{\"href\":row.link,\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_c('div',{staticClass:\"flex-right\"},[_vm._v(\" \"+_vm._s(row.name)+\" \")])])]):_c('td',[_c('div',{staticClass:\"flex-right\"},[_vm._v(\" \"+_vm._s(row.name)+\" \")]),_c('div',{staticClass:\"bg-error\"},[_vm._v(\" \"+_vm._s(row.status)+\" \")])])]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport SortableTable from '@shell/components/SortableTable';\nimport { SERVICE } from '@shell/config/types';\n\nconst VERSION = '0.1.0';\n\nexport default {\n  name:       'ServicesDashboardCard',\n  components: { SortableTable },\n  props:      {\n    resource: {\n      type:     Object,\n      required: true\n    }\n  },\n  async fetch() {\n    await this.fetchDeps();\n  },\n  data() {\n    const gpuCardIconSrc = require('@pkg/services-ui/icons/gpu-card.svg');\n    const gearIconSrc = require('@pkg/services-ui/icons/gear.svg');\n\n    return {\n      version:        VERSION,\n      icons:   {\n        'gpu-card': gpuCardIconSrc,\n        gear:       gearIconSrc\n      },\n      externalLinks:   [],\n      showBrokenLinks: false,\n      tableHeaders:    [\n        {\n          name:          'namespace',\n          label:         'Namespace',\n          value:         'namespace'\n        },\n        {\n          name:          'name',\n          label:         'Name',\n          value:         'name'\n        },\n        {\n          name:          'description',\n          label:         'Description',\n          value:         'description'\n        },\n      ]\n    };\n  },\n  methods: {\n\n    async fetchDeps() {\n      const { icons, externalLinks } = this;\n\n      const currentCluster = this.$store.getters['currentCluster'];\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const services = await this.$store.dispatch(`${ inStore }/findAll`, { type: SERVICE });\n\n      // console.log('SERVICES::');\n\n      for (const serviceIndex in services) {\n        const service = services[serviceIndex];\n        const serviceName = service.metadata.name;\n        const serviceNamespace = service.metadata.namespace;\n\n        // console.log(`Check ${ serviceIndex }-th service ${ serviceNamespace }/${ serviceName }`);\n        // console.log(service);\n\n        for (const port of service.spec.ports) {\n          if (port.protocol !== 'TCP') {\n            continue;\n          }\n\n          const portName = port.name ?? '';\n          const portNum = port.port ?? 0;\n\n          if (portNum <= 0) {\n            continue;\n          }\n\n          let isHttps = portName.includes('https');\n          let isHttp = portName.includes('http') && !isHttps;\n\n          if (!isHttp && !isHttps) {\n            switch (portNum) {\n            case 80:\n            case 8080:\n              isHttp = true;\n              break;\n            case 443:\n            case 8443:\n            case 6443:\n              isHttps = true;\n              break;\n            }\n          }\n\n          if (!isHttp && !isHttps) {\n            continue;\n          }\n\n          await service.fetchPods();\n\n          const servicePort = portNum;\n          const serviceProtocol = isHttp ? 'http' : 'https';\n          const serviceDescription = isHttp ? `HTTP service on port ${ portNum }` : `HTTPS service on port ${ portNum }`;\n          const serviceId = `${ serviceNamespace }/${ serviceName }:${ portNum }`;\n\n          const serviceLink = `/k8s/clusters/${ currentCluster.id }/api/v1/namespaces/${ serviceNamespace }/services/${ serviceProtocol }:${ serviceName }:${ servicePort }/proxy`;\n\n          let serviceLinkEnabled = true;\n          let serviceLinkStatus = '';\n\n          if (service.pods.length === 0) {\n            serviceLinkEnabled = false;\n            serviceLinkStatus = 'No endpoint pods';\n          } else {\n            try {\n              const response = await this.$axios.get(serviceLink, { timeout: 5000 });\n\n              serviceLinkEnabled = response && response.status === 200;\n\n              if (response) {\n                if (response.status !== 200) {\n                  serviceLinkStatus = `Could not get link, status code: ${ response.status.toString() }`;\n                }\n              } else {\n                serviceLinkStatus = 'Could not get link, no status code';\n              }\n            } catch (e) {\n              serviceLinkEnabled = false;\n              serviceLinkStatus = `Could not get link: ${ e.toString() }`;\n            }\n          }\n\n          externalLinks.push({\n            enabled:     serviceLinkEnabled,\n            iconSrc:     icons.gear,\n            kind:        'service',\n            namespace:   serviceNamespace,\n            name:        serviceName,\n            description: serviceDescription,\n            id:          serviceId,\n            link:        serviceLink,\n            status:      serviceLinkStatus\n          });\n        }\n      }\n    },\n\n    toggleShowBrokenLinks() {\n      this.showBrokenLinks = !this.showBrokenLinks;\n    }\n  },\n  computed: {\n    serviceLinks() {\n      return this.externalLinks.filter(link => link.enabled || this.showBrokenLinks);\n    },\n    toggleShowBrokenLinksButtonName() {\n      return this.showBrokenLinks ? this.t('services.list.hide-broken-links') : this.t('services.list.show-broken-links');\n    }\n  }\n};\n</script>\n<template>\n  <div>\n    <SortableTable\n      :rows=\"serviceLinks\"\n      :headers=\"tableHeaders\"\n      key-field=\"id\"\n      :table-actions=\"false\"\n      :search=\"true\"\n    >\n      <template #header-middle>\n        <button\n          type=\"button\"\n          class=\"btn btn-sm role-secondary\"\n          :disabled=\"false\"\n          @click=\"toggleShowBrokenLinks()\"\n        >\n          {{ toggleShowBrokenLinksButtonName }}\n        </button>\n      </template>\n      <template #col:name=\"{row}\">\n        <td v-if=\"row.enabled\">\n          <a\n            v-clean-tooltip=\"!row.enabled ? t('services.list.na') : undefined\"\n            :href=\"row.link\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            :class=\"{ disabled: !row.enabled }\"\n          ><div class=\"flex-right\">\n            {{ row.name }}\n          </div>\n          </a>\n        </td>\n        <td v-else>\n          <div class=\"flex-right\">\n            {{ row.name }}\n          </div>\n          <div class=\"bg-error\">\n            {{ row.status }}\n          </div>\n        </td>\n      </template>\n    </SortableTable>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .create-resource-container .subtype-banner {\n    min-height: 80px;\n    padding: 10px;\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ServicesDashboardCard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ServicesDashboardCard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ServicesDashboardCard.vue?vue&type=template&id=43fccdda&scoped=true&\"\nimport script from \"./ServicesDashboardCard.vue?vue&type=script&lang=js&\"\nexport * from \"./ServicesDashboardCard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ServicesDashboardCard.vue?vue&type=style&index=0&id=43fccdda&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43fccdda\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/gpu-card.587d9839.svg\";","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ServicesDashboardCard.vue?vue&type=style&index=0&id=43fccdda&prod&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".create-resource-container .subtype-banner[data-v-43fccdda]{min-height:80px;padding:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var map = {\n\t\"./csp/metadata.json\": \"7f57\",\n\t\"./federal/metadata.json\": \"66fa\",\n\t\"./rgs/metadata.json\": \"45d2\",\n\t\"./suse/metadata.json\": \"1d5f\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"dad7\";"],"sourceRoot":""}